drop pitr if exists pitr01;
create pitr pitr01 for account range 1 'h';
drop snapshot if exists sp01;
create snapshot sp01 for account;
drop database if exists test;
create database test;
use test;
create table t1(col int, col2 int);
insert into t1 values(1,1);
create table t2(col int, col2 int);
insert into t2 values(2,2);
create table t3(col int, col2 int);
insert into t3 values(3,3);
drop pitr if exists pitr02;
create pitr pitr02 for database test range 1 'h';
drop snapshot if exists sp02;
create snapshot sp02 for database test;
drop pitr if exists pitr03;
create pitr pitr03 for table test t1 range 1 'h';
drop snapshot if exists sp03;
create snapshot sp03 for table test t1;
drop pitr if exists pitr04;
create pitr pitr04 for table test t2 range 1 'h';
drop snapshot if exists sp04;
create snapshot sp04 for table test t2;
drop pitr if exists pitr05;
create pitr pitr05 for table test t3 range 1 'h';
drop snapshot if exists sp05;
create snapshot sp05 for table test t3;
show recovery_window for account;
Recovery_Window_Level    Account_Name    Database_Name    Table_Name    Recovery_Windows
database    sys    test    t1    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr03"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr02"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr01"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp03"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp02"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp01"}
database    sys    test    t2    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr04"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr02"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr01"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp04"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp02"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp01"}
database    sys    test    t3    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr05"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr02"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:54:59", "source": "pitr", "source_name": "pitr01"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp05"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp02"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp01"}
show recovery_window for database test;
Recovery_Window_Level    Account_Name    Database_Name    Table_Name    Recovery_Windows
database    sys    test    t1    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr03"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr02"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp03"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp02"}
database    sys    test    t2    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr04"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr02"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp04"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp02"}
database    sys    test    t3    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr05"},\n{"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr02"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp05"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp02"}
show recovery_window for table test t1;
Recovery_Window_Level    Account_Name    Database_Name    Table_Name    Recovery_Windows
table    sys    test    t1    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr03"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp03"}
show recovery_window for table test t2;
Recovery_Window_Level    Account_Name    Database_Name    Table_Name    Recovery_Windows
table    sys    test    t2    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr04"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp04"}
show recovery_window for table test t3;
Recovery_Window_Level    Account_Name    Database_Name    Table_Name    Recovery_Windows
table    sys    test    t3    {"start_time": "2025-01-08 15:54:59", "end_time": "2025-01-08 15:55:04", "source": "pitr", "source_name": "pitr05"},\n{"timestamp": "2025-01-08 15:54:59", "source": "snapshot", "source_name": "sp05"}
drop database test;
drop snapshot sp01;
drop snapshot sp02;
drop snapshot sp03;
drop snapshot sp04;
drop snapshot sp05;
drop pitr pitr01;
drop pitr pitr02;
drop pitr pitr03;
drop pitr pitr04;
drop pitr pitr05;
