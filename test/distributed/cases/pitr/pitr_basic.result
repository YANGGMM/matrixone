drop pitr if exists pitr01;
create pitr pitr01 range 1 'h';
drop pitr if exists pitr02;
create pitr pitr02 range 1 'd';
drop pitr if exists pitr03;
create pitr pitr03 range 1 'mo';
drop pitr if exists pitr04;
create pitr pitr04 range 1 'y';
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr01    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
drop pitr if exists pitr05;
create pitr pitr05 for cluster range 1 'h';
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr01    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
pitr05    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster                1    h
create pitr pitr01 range 1 'h';
internal error: pitr pitr01 already exists
create pitr if not exists pitr01 range 1 'h';
create pitr pitr07 for account acc01 database mo_catalog range 1 'h';
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 45 near " database mo_catalog range 1 'h';";
create pitr pitr08 for account acc01 database mo_catalog table mo_table range 1 'h';
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 45 near " database mo_catalog table mo_table range 1 'h';";
create pitr pitr09 range 1 'yy';
internal error: invalid pitr unit yy
create pitr pitr09 range -1 'h';
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 26 near " -1 'h';";
create pitr pitr09 range 2000 'h';
internal error: invalid pitr value 2000
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr01    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
pitr05    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster                1    h
create database db01;
drop pitr if exists pitr10;
create pitr pitr10 for database db01 range 1 'h';
create pitr pitr11 for database db02 range 1 'h';
internal error: database db02 does not exist
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr01    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
pitr05    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster                1    h
pitr10    2024-07-18 06:55:49    2024-07-18 06:55:49    database    sys    db01        1    h
create table db01.table01 (col1 int);
drop pitr if exists pitr12;
create pitr pitr12 for database db01 table table01 range 1 'h';
create pitr pitr13 for database db01 table table02 range 1 'h';
internal error: table table02 does not exist
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr01    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
pitr05    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster                1    h
pitr10    2024-07-18 06:55:49    2024-07-18 06:55:49    database    sys    db01        1    h
pitr12    2024-07-18 06:55:49    2024-07-18 06:55:49    table    sys    db01    table01    1    h
create account acc01 admin_name = 'test_account' identified by '111';
drop pitr if exists pitr14;
create pitr pitr14 for account acc01 range 1 'h';
create pitr pitr15 for account acc02 range 1 'h';
internal error: account acc02 does not exist
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr14    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
pitr01    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
pitr05    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster                1    h
pitr10    2024-07-18 06:55:49    2024-07-18 06:55:49    database    sys    db01        1    h
pitr12    2024-07-18 06:55:49    2024-07-18 06:55:49    table    sys    db01    table01    1    h
drop pitr if exists pitr16;
create pitr pitr16 range 1 'h';
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr16    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
create pitr pitr16 range 1 'h';
internal error: pitr pitr16 already exists
create pitr pitr16 if not exists range 1 'h';
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 21 near " if not exists range 1 'h';";
create pitr pitr17 for cluster range 1 'h';
internal error: only sys tenant can create cluster level pitr
create pitr pitr18 for account acc01 range 1 'h';
internal error: only sys tenant can create tenant level pitr for other tenant
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr16    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
create database db01;
drop pitr if exists pitr19;
create pitr pitr19 for database db01 range 1 'h';
create pitr pitr20 for database db02 range 1 'h';
internal error: database db02 does not exist
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr16    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
pitr19    2024-07-18 06:55:51    2024-07-18 06:55:51    database    acc01    db01        1    h
create table db01.table01 (col1 int);
drop pitr if exists pitr21;
create pitr pitr21 for database db01 table table01 range 1 'h';
create pitr pitr22 for database db01 table table02 range 1 'h';
internal error: table table02 does not exist
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr21    2024-07-18 06:55:52    2024-07-18 06:55:52    table    acc01    db01    table01    1    h
pitr16    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
pitr19    2024-07-18 06:55:51    2024-07-18 06:55:51    database    acc01    db01        1    h
alter pitr pitr01 range 1 'd';
You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 77 near " %!d(string=d), pitr_unit = 'pitr01' where pitr_name = '%!s(uint64=0)' and create_account = %!d(MISSING);";
alter pitr pitr100 range 1 'd';
internal error: pitr pitr100 does not exist
alter pitr if exists pitr100 range 1 'd';
alter pitr pitr01 range 1 'yy';
internal error: invalid pitr unit yy
alter pitr pitr01 range -1 'd';
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 25 near " -1 'd';";
alter pitr pitr01 range 2000 'd';
internal error: invalid pitr value 2000
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr14    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
pitr01    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
pitr05    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster                1    h
pitr10    2024-07-18 06:55:49    2024-07-18 06:55:49    database    sys    db01        1    h
pitr12    2024-07-18 06:55:49    2024-07-18 06:55:49    table    sys    db01    table01    1    h
drop pitr pitr01;
drop pitr pitr100;
internal error: pitr pitr100 does not exist
drop pitr if exists pitr100;
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr14    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
pitr02    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    d
pitr03    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    mo
pitr04    2024-07-18 06:55:49    2024-07-18 06:55:49    account    sys            1    y
pitr05    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster                1    h
pitr10    2024-07-18 06:55:49    2024-07-18 06:55:49    database    sys    db01        1    h
pitr12    2024-07-18 06:55:49    2024-07-18 06:55:49    table    sys    db01    table01    1    h
alter pitr pitr16 range 1 'd';
You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 77 near " %!d(string=d), pitr_unit = 'pitr16' where pitr_name = '%!s(uint64=2)' and create_account = %!d(MISSING);";
alter pitr pitr100 range 1 'd';
internal error: pitr pitr100 does not exist
alter pitr if exists pitr100 range 1 'd';
alter pitr pitr16 range 1 'yy';
internal error: invalid pitr unit yy
alter pitr pitr16 range -1 'd';
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 25 near " -1 'd';";
alter pitr pitr16 range 2000 'd';
internal error: invalid pitr value 2000
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr21    2024-07-18 06:55:52    2024-07-18 06:55:52    table    acc01    db01    table01    1    h
pitr16    2024-07-18 06:55:51    2024-07-18 06:55:51    account    acc01            1    h
pitr19    2024-07-18 06:55:51    2024-07-18 06:55:51    database    acc01    db01        1    h
drop pitr pitr16;
drop pitr pitr100;
internal error: pitr pitr100 does not exist
drop pitr if exists pitr100;
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
pitr21    2024-07-18 06:55:52    2024-07-18 06:55:52    table    acc01    db01    table01    1    h
pitr19    2024-07-18 06:55:51    2024-07-18 06:55:51    database    acc01    db01        1    h
drop pitr if exists pitr19;
drop pitr if exists pitr21;
select * from mo_catalog.mo_pitr;
pitr_id    pitr_name    create_account    create_time    modified_time    level    account_id    account_name    database_name    table_name    obj_id    pitr_length    pitr_unit
0190c4a0-2c55-7893-826f-38fc83e71080    pitr02    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    d
0190c4a0-2c59-7c73-9a24-8fa506b93b51    pitr03    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    mo
0190c4a0-2c5f-7bfe-b3a9-a6973d32e906    pitr04    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    y
0190c4a0-2c78-7bdf-a5f5-c01f5d8bc741    pitr05    0    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster    0                0    1    h
0190c4a0-2c9e-7dd3-85d7-4ecc80773640    pitr10    0    2024-07-18 06:55:49    2024-07-18 06:55:49    database    0    sys    db01        272588    1    h
0190c4a0-2cb6-7b08-86b6-aa9161668282    pitr12    0    2024-07-18 06:55:49    2024-07-18 06:55:49    table    0    sys    db01    table01    272589    1    h
0190c4a0-3416-7c15-a037-148704d8caa7    pitr14    0    2024-07-18 06:55:51    2024-07-18 06:55:51    account    2    acc01            2    1    h
drop account if exists acc01;
select * from mo_catalog.mo_pitr;
pitr_id    pitr_name    create_account    create_time    modified_time    level    account_id    account_name    database_name    table_name    obj_id    pitr_length    pitr_unit
0190c4a0-2c55-7893-826f-38fc83e71080    pitr02    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    d
0190c4a0-2c59-7c73-9a24-8fa506b93b51    pitr03    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    mo
0190c4a0-2c5f-7bfe-b3a9-a6973d32e906    pitr04    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    y
0190c4a0-2c78-7bdf-a5f5-c01f5d8bc741    pitr05    0    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster    0                0    1    h
0190c4a0-2c9e-7dd3-85d7-4ecc80773640    pitr10    0    2024-07-18 06:55:49    2024-07-18 06:55:49    database    0    sys    db01        272588    1    h
0190c4a0-2cb6-7b08-86b6-aa9161668282    pitr12    0    2024-07-18 06:55:49    2024-07-18 06:55:49    table    0    sys    db01    table01    272589    1    h
0190c4a0-3416-7c15-a037-148704d8caa7    pitr14    0    2024-07-18 06:55:51    2024-07-18 06:55:51    account    2    acc01            2    1    h
drop database if exists db01;
select * from mo_catalog.mo_pitr;
pitr_id    pitr_name    create_account    create_time    modified_time    level    account_id    account_name    database_name    table_name    obj_id    pitr_length    pitr_unit
0190c4a0-2c55-7893-826f-38fc83e71080    pitr02    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    d
0190c4a0-2c59-7c73-9a24-8fa506b93b51    pitr03    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    mo
0190c4a0-2c5f-7bfe-b3a9-a6973d32e906    pitr04    0    2024-07-18 06:55:49    2024-07-18 06:55:49    account    0    sys            0    1    y
0190c4a0-2c78-7bdf-a5f5-c01f5d8bc741    pitr05    0    2024-07-18 06:55:49    2024-07-18 06:55:49    cluster    0                0    1    h
0190c4a0-2c9e-7dd3-85d7-4ecc80773640    pitr10    0    2024-07-18 06:55:49    2024-07-18 06:55:49    database    0    sys    db01        272588    1    h
0190c4a0-2cb6-7b08-86b6-aa9161668282    pitr12    0    2024-07-18 06:55:49    2024-07-18 06:55:49    table    0    sys    db01    table01    272589    1    h
0190c4a0-3416-7c15-a037-148704d8caa7    pitr14    0    2024-07-18 06:55:51    2024-07-18 06:55:51    account    2    acc01            2    1    h
drop pitr if exists pitr01;
drop pitr if exists pitr02;
drop pitr if exists pitr03;
drop pitr if exists pitr04;
drop pitr if exists pitr05;
drop pitr if exists pitr10;
drop pitr if exists pitr12;
drop pitr if exists pitr14;
show pitr;
PITR_NAME    CREATED_TIME    MODIFIED_TIME    PITR_LEVEL    ACCOUNT_NAME    DATABASE_NAME    TABLE_NAME    PITR_LENGTH    PITR_UNIT
select * from mo_catalog.mo_pitr;
pitr_id    pitr_name    create_account    create_time    modified_time    level    account_id    account_name    database_name    table_name    obj_id    pitr_length    pitr_unit
